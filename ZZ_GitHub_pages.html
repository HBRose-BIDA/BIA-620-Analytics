# Function to generate the correct Microsoft Viewer link for Office files
def format_office_link(file_name, github_url):
    return f'<a href="https://view.officeapps.live.com/op/view.aspx?src={github_url}" target="_blank">{file_name}</a>'

# Generate HTML content for Office files only
html_office_content = """<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Class Projects - Office Files</title>
</head>
<body>
    <h1>Master Class Projects</h1>
    <p>This page provides access to Office documents.</p>
    <h2>Office Files</h2>
    <ul>
"""

# Add links for each Office file
for index, row in df_office.iterrows():
    html_office_content += f"        <li>{format_office_link(row['File Name'], row['GitHub URL'])}</li>\n"

# Close the HTML structure
html_office_content += """    </ul>
</body>
</html>"""

# Save the HTML file
html_office_file_path = "/mnt/data/ZZ_GitHub_Office_Files.html"
with open(html_office_file_path, "w", encoding="utf-8") as f:
    f.write(html_office_content)

# Provide the file for download
html_office_file_path
